
<!doctype html>
<html lang="it" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Collection of FAQ for Electronic Makers">
      
      
        <meta name="author" content="Alessandro Varesi">
      
      
        <link rel="canonical" href="https://novice-handbooks.github.io/maker/proxmoxonoci/">
      
      
        <link rel="prev" href="../ocifreetier/">
      
      
        <link rel="next" href="../dockeronoci/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Installa Proxmox VE 8 su Oracle OCI (free tier) - Alv67 Maker FAQ</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installa-proxmox-ve-8-su-oracle-oci-free-tier" class="md-skip">
          Vai al contenuto
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Intestazione">
    <a href=".." title="Alv67 Maker FAQ" class="md-header__button md-logo" aria-label="Alv67 Maker FAQ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Alv67 Maker FAQ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Installa Proxmox VE 8 su Oracle OCI (free tier)
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Cancella" aria-label="Cancella" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inizializza la ricerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/novice-handbooks/maker" title="Apri repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    novice-handbooks/maker
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigazione" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Alv67 Maker FAQ" class="md-nav__button md-logo" aria-label="Alv67 Maker FAQ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Alv67 Maker FAQ
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/novice-handbooks/maker" title="Apri repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    novice-handbooks/maker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    M5Stack CORE Fire
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            M5Stack CORE Fire
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../m5stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programmazione scheda con Arduino IDE
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Raspberry Pi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Raspberry Pi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RaspberryPI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installazione Raspberry Pi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homeassistant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home Assistenat su Raspberry Pi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raspi5nvme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Raspberry Pi 5 con NVMe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxmoxonpi5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installa Proxmox su Raspberry Pi OS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Homelab & Homeserver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Homelab & Homeserver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pihole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installazione e configurazione server Pi-hole su Proxmox VE
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Servizi cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Servizi cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ocifreetier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oracle Cloud Interface OCI free tier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Installa Proxmox VE 8 su Oracle OCI (free tier)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Installa Proxmox VE 8 su Oracle OCI (free tier)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Indice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Indice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#debian-su-istanza-vmstandarda1flex" class="md-nav__link">
    <span class="md-ellipsis">
      Debian su istanza VM.Standard.A1.Flex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurazione-di-debian" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione di Debian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurazione-della-rete" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione della rete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configurazione della rete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#impostazione-ip-statico" class="md-nav__link">
    <span class="md-ellipsis">
      Impostazione IP statico
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-file-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Edit file /etc/hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installare-proxmox-ve-su-debian-bookworm" class="md-nav__link">
    <span class="md-ellipsis">
      Installare Proxmox VE su Debian bookworm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installare Proxmox VE su Debian bookworm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggiungere-il-repository-di-proxmox-ve" class="md-nav__link">
    <span class="md-ellipsis">
      Aggiungere il repository di Proxmox VE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installiamo-i-pacchetti-proxmox-ve" class="md-nav__link">
    <span class="md-ellipsis">
      Installiamo i pacchetti Proxmox VE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-alla-console-di-controllo-porta-8006" class="md-nav__link">
    <span class="md-ellipsis">
      Accesso alla console di controllo (porta 8006)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accesso alla console di controllo (porta 8006)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pubblicazione-della-porta" class="md-nav__link">
    <span class="md-ellipsis">
      Pubblicazione della porta
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilizzo-di-una-vpn-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      Utilizzo di una VPN (Tailscale)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilizzo di una VPN (Tailscale)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configurazione-personalizzata-per-oracle-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione personalizzata per Oracle Cloud
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configurazione personalizzata per Oracle Cloud">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-autorizza-porta-udp-41641" class="md-nav__link">
    <span class="md-ellipsis">
      1. Autorizza porta UDP 41641
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pubblica-tutta-la-sottorete-vcn-tramite-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      2. Pubblica tutta la sottorete VCN tramite Tailscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-aggiungere-oracle-dns-alla-tailnet" class="md-nav__link">
    <span class="md-ellipsis">
      3. Aggiungere Oracle DNS alla tailnet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-alla-console-e-prima-configurazione" class="md-nav__link">
    <span class="md-ellipsis">
      Accesso alla console e prima configurazione
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accesso alla console e prima configurazione">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggiunta-del-repository-di-proxmox" class="md-nav__link">
    <span class="md-ellipsis">
      Aggiunta del repository di Proxmox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creare-un-cluster-proxmox-tra-due-nodi-connessi-tramite-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      Creare un cluster Proxmox tra due nodi connessi tramite tailscale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creare un cluster Proxmox tra due nodi connessi tramite tailscale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-imposta-correttamente-etchosts-su-entrambi-i-nodi" class="md-nav__link">
    <span class="md-ellipsis">
      1. Imposta correttamente /etc/hosts su entrambi i nodi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-creare-il-cluster-sul-nodo-principale-pve1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Creare il cluster sul nodo principale (pve1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-modificare-la-configurazione-del-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      3. Modificare la configurazione del cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggiungere-il-secondo-nodo-pve2" class="md-nav__link">
    <span class="md-ellipsis">
      4. Aggiungere il secondo nodo (pve2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-verificare-lo-stato-del-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      5. Verificare lo stato del cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dockeronoci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installa Docker su Oracle OCI (free tier)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudflaressh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pubblicare l'accesso SSH tramite Cloudflare Tunnel
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Indice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Indice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#debian-su-istanza-vmstandarda1flex" class="md-nav__link">
    <span class="md-ellipsis">
      Debian su istanza VM.Standard.A1.Flex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurazione-di-debian" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione di Debian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurazione-della-rete" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione della rete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configurazione della rete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#impostazione-ip-statico" class="md-nav__link">
    <span class="md-ellipsis">
      Impostazione IP statico
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-file-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Edit file /etc/hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installare-proxmox-ve-su-debian-bookworm" class="md-nav__link">
    <span class="md-ellipsis">
      Installare Proxmox VE su Debian bookworm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installare Proxmox VE su Debian bookworm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggiungere-il-repository-di-proxmox-ve" class="md-nav__link">
    <span class="md-ellipsis">
      Aggiungere il repository di Proxmox VE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installiamo-i-pacchetti-proxmox-ve" class="md-nav__link">
    <span class="md-ellipsis">
      Installiamo i pacchetti Proxmox VE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-alla-console-di-controllo-porta-8006" class="md-nav__link">
    <span class="md-ellipsis">
      Accesso alla console di controllo (porta 8006)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accesso alla console di controllo (porta 8006)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pubblicazione-della-porta" class="md-nav__link">
    <span class="md-ellipsis">
      Pubblicazione della porta
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilizzo-di-una-vpn-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      Utilizzo di una VPN (Tailscale)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilizzo di una VPN (Tailscale)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configurazione-personalizzata-per-oracle-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Configurazione personalizzata per Oracle Cloud
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configurazione personalizzata per Oracle Cloud">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-autorizza-porta-udp-41641" class="md-nav__link">
    <span class="md-ellipsis">
      1. Autorizza porta UDP 41641
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pubblica-tutta-la-sottorete-vcn-tramite-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      2. Pubblica tutta la sottorete VCN tramite Tailscale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-aggiungere-oracle-dns-alla-tailnet" class="md-nav__link">
    <span class="md-ellipsis">
      3. Aggiungere Oracle DNS alla tailnet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-alla-console-e-prima-configurazione" class="md-nav__link">
    <span class="md-ellipsis">
      Accesso alla console e prima configurazione
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accesso alla console e prima configurazione">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggiunta-del-repository-di-proxmox" class="md-nav__link">
    <span class="md-ellipsis">
      Aggiunta del repository di Proxmox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creare-un-cluster-proxmox-tra-due-nodi-connessi-tramite-tailscale" class="md-nav__link">
    <span class="md-ellipsis">
      Creare un cluster Proxmox tra due nodi connessi tramite tailscale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creare un cluster Proxmox tra due nodi connessi tramite tailscale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-imposta-correttamente-etchosts-su-entrambi-i-nodi" class="md-nav__link">
    <span class="md-ellipsis">
      1. Imposta correttamente /etc/hosts su entrambi i nodi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-creare-il-cluster-sul-nodo-principale-pve1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Creare il cluster sul nodo principale (pve1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-modificare-la-configurazione-del-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      3. Modificare la configurazione del cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggiungere-il-secondo-nodo-pve2" class="md-nav__link">
    <span class="md-ellipsis">
      4. Aggiungere il secondo nodo (pve2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-verificare-lo-stato-del-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      5. Verificare lo stato del cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="installa-proxmox-ve-8-su-oracle-oci-free-tier">Installa Proxmox VE 8 su Oracle OCI (free tier)</h1>
<p>[<em>documento editato il 2025-05-06</em>]</p>
<p>Oracle nella piattaforma <em>Oracle Cloud Infrastructure</em> (OCI) mette a dispisizione un ottimo <em>tier gratuito</em>
In questo <em>tier</em> sono disponibili risorse per creare instanze di macchine virtuali nel piano che viene indicato come <em>always-free</em>.</p>
<p>In particolare si hanno a disposizione:</p>
<ul>
<li>due instanze AMD x86_64 con 1/8 OCPU (corrispondenti a 2 vCPU) e 1GB di RAM.</li>
<li>una istanza ARM-based 4 core e 24 GB di RAM</li>
</ul>
<p>Inoltre si hanno a disposizione 200GB di blocco dati da utilizzare come memoria di massa.
Siccome il minimo utilizzabile per ogni istanza è pari a 49GB, alla fine si consiglia di utilizzare:</p>
<ul>
<li>100GB per la istanza ARM-Based</li>
<li>50GB per ogni istanza AMD</li>
</ul>
<p>Fatta questa premessa è chiaro che se si intende utilizzare una istanza OCI per far girare un server Proxmox VE allora l'unica
possibilità è quella di utilizza l'istanza ARM-based che presenta una buona quantità di
memoria RAM, risorsa indispensabile per il sistema Proxmox VE.</p>
<p>Essendo questa una macchina con architettura ARM buona parte della configurazione sarà simile a quanto già rappresentato nel documento:
<a href="../proxmoxonpi5/">Installa Proxmox 8 su Raspberry Pi 5</a>.</p>
<p>La vera difficoltà è quella di riuscire ad installare l'immagine di
Proxmox VE sull'istanza OCI, inquanto è una immagine non prevista dal
sistema automatizzato messo a disposizione da Oracle.</p>
<blockquote>
<p><strong>Reference</strong></p>
<p>Buona parte delle procedure di seguito elencate sono state descritte
sul <a href="https://frank-ruan.com">Frank Ruan's Blog</a> ed in particolare
nell'articolo: <a href="https://frank-ruan.com/2023/03/18/installing-proxmox-ve-on-oci/">Installing Proxmox VE on OCI</a></p>
</blockquote>
<h2 id="debian-su-istanza-vmstandarda1flex">Debian su istanza VM.Standard.A1.Flex</h2>
<p>Si da qui per scontato che sia stata creata una instanza selezionando l'architettura ARM-based e collegando un blocco dati
di 100GB.</p>
<p>Occorre segnarsi l'indirizzo IP pubblico dell'istanza ed avere accesso alla console di controllo.
Inoltre occorre avere l'accesso <em>ssh</em> remoto, normalmente viene utilizzato una chiave pubblica fornita in fase di creazione dell'istanza.</p>
<p>Ora occorre assicurarsi di avere settato il firewall per permettere al traffico internet di raggiungere l'istanza.</p>
<p>Connettersi all'istanza tramite connessioe SSH ed scaricare l'immagine necessaria per installare il da rete Proxmox:</p>
<pre><code class="language-shell">sudo -i
cd /boot/efi
wget https://boot.netboot.xyz/ipxe/netboot.xyz-arm64.efi
</code></pre>
<p>Una volta eseguito il download sconnettersi dalla macchina. Ora dovremo far ripartire la
macchina cercando di intercettare al boot in modo da utilizzare l'immagine appena scaricata.</p>
<p>Nella pagina di interfaccia di OCI assicurarsi di avere lanciato la Console collegata
all'istanza. Per fare questo, una volta selezionata l'istanza, scegliere la voce <em>Console connection</em> presente nel menù laterale.</p>
<p>La qui utilizzare "Lauch Cloud Shell connection". Questo apre a fondo pagina una console (Cloud Shell) connessa all'istanza.</p>
<p>Seguire attendamente le seguenti operazioni:</p>
<ol>
<li>
<p>dalla pagina detaggli operare sul comando <em>Reboot</em> e scegliere l'opzione 'Force reboot the
instance by immediately powering off, then powering back on'</p>
</li>
<li>
<p>Fare attenzione a ciò che avviene nella console (Cloud Shell) e premere <code>ESC</code> quando inizia
il reboot per far apparire la configurazione del Bios.
<img alt="Oci Bios" src="../images/oci-bios.png" /></p>
</li>
<li>
<p>Utilizzando le frecce per muoversi selezionare:
<code>Boot Maintenance Manager</code> -&gt; <code>Boot From File</code> -&gt; Scegli il file dall'hard disk <code>netboot.xyz-arm64.efi</code></p>
</li>
<li>
<p>Se tutto è andato come da copione si presenta l'interfaccia iPXE seguente
<img alt="iPXE Boot" src="../images/ipxe-boot.png" /></p>
</li>
<li>
<p>Seleziona <code>Linux Network Installs</code> -&gt; <code>Debian</code> -&gt; <code>Debian 12.0 (bookworm)</code> -&gt; <code>Text Based Install</code></p>
</li>
<li>
<p>procedere con l'istallazione facendo attenzione nel momento in cui chiede il partizionamento:
scegliere 'Guided - use entire disk and set up LVM'
<img alt="iPXE partition" src="../images/ipxe-partition.png" /></p>
</li>
<li>
<p>A seguire accettare tutte le impostazioni di default</p>
</li>
<li>
<p>Riavviare il sistema</p>
</li>
</ol>
<h2 id="configurazione-di-debian">Configurazione di Debian</h2>
<p>Una volta installato, il sistema ha la necessità di alcune configurazioni utili per essere facilmente utilizzato.</p>
<ol>
<li>
<p>Connessione SSH con utente (non root) creato durante l'installazione utilizzando l'indirizzo pubblico della istanza.</p>
</li>
<li>
<p>installare 'sudo' e vari altri software utili</p>
</li>
</ol>
<p><code>shell
   su -
   Password: (inserire la password di root)
   apt update
   apt install sudo wget curl iftop vnstat neofetch vim nano net-tools
   exit</code></p>
<ol>
<li>aggiungere l'utente standard ai 'sudoers'. Lavorando sempre come 'root' eseguire</li>
</ol>
<p><code>shell
   su -
   usermod -aG sudo [nome utente]
   groups [nomeutente]
   exit</code></p>
<p>L'utente deve uscire e rientrare affinchè venga caricata l'appartenenza al gruppo 'sudo'</p>
<ol>
<li>(Opzionale) abilitare sudo senza password</li>
</ol>
<p><code>shell
   sudo visudo</code></p>
<p>Editare il file aperto, cercare la linea con <code>%sudo ...</code> e modificarla in</p>
<p><code>text
   %sudo   ALL=(ALL:ALL) NOPASSWD:ALL</code></p>
<p>Chiudere il file con <code>Ctrl+x</code>, <code>y</code>, <code>Invio</code></p>
<ol>
<li>(Opzionale) aggiungere chiave pubblica per connessione SSH senza necessita di inserimento password.</li>
</ol>
<p>Dal proprio computer eseguire il comando:</p>
<p><code>shell
   ssh-copy-id -i .ssh/[chiave]] [user]@[ip-address]</code></p>
<p>Viene chiesta la password e al termine dovrebbe indicare di aver copiato una chiave</p>
<h2 id="configurazione-della-rete">Configurazione della rete</h2>
<p>Si andrà a configurare la rete con IP statico.</p>
<p>Segnarsi l'indirizzo IP della macchina virtuale letto tramite il comando <code>ip address</code></p>
<p>Nel mio caso : <code>10.0.0.177</code></p>
<h3 id="impostazione-ip-statico">Impostazione IP statico</h3>
<p>Editare il file <code>/etc/network/interfaces</code></p>
<p>Il file si presenta così:</p>
<pre><code class="language-text"># This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
allow-hotplug enp0s3
iface enp0s3 inet dhcp
</code></pre>
<p>Occorre modificare la parte finale in :</p>
<pre><code class="language-text"># The primary network interface
allow-hotplug enp0s3
# iface enp0s3 inet dhcp
# Define Static IP
iface enp0s3 inet static
   address 10.0.0.117
   netmask 255.255.0.0
   gateway 10.0.0.1
</code></pre>
<h3 id="edit-file-etchosts">Edit file /etc/hosts</h3>
<p>Editare il file <code>/etc/hosts</code> che dovrebbe essere simile a:</p>
<pre><code class="language-text">127.0.0.1       localhost
127.0.1.1      pve-oci.vcn01191127.oraclevcn.com       pve-oci

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre>
<p>Modificarlo in (sostituire HOSTNAME con il proprio hostname, nel mio caso <code>pve-oci</code>):</p>
<pre><code class="language-text">127.0.0.1    localhost.localdomain  localhost
PUBLIC_IP    HOSTNAME.proxmox.com   HOSTNAME

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre>
<p>Riavviare l'istanza.</p>
<h2 id="installare-proxmox-ve-su-debian-bookworm">Installare Proxmox VE su Debian bookworm</h2>
<blockquote>
<p><strong>Reference</strong></p>
<p>Si fa riferimento alla guida ufficiale del porting di Proxmox su architettura arm64</p>
<p><a href="https://github.com/jiangcuo/Proxmox-Port/wiki/Install-Proxmox-VE-on-Debian-bookworm">Install Proxmox VE on Debian bookworm</a></p>
</blockquote>
<h3 id="aggiungere-il-repository-di-proxmox-ve">Aggiungere il repository di Proxmox VE</h3>
<p>Occorre eseguire i seguenti comandi come <code>root</code>, quindi invocare il comando <code>sudo su -</code></p>
<p>Aggiungiamo mil repository</p>
<pre><code class="language-shell">echo 'deb [arch=arm64] https://mirrors.apqa.cn/proxmox/debian/pve bookworm port'&gt;/etc/apt/sources.list.d/pveport.list
</code></pre>
<p>Aggiungiamo la chive del repository</p>
<pre><code class="language-shell">curl -L https://mirrors.apqa.cn/proxmox/debian/pveport.gpg -o /etc/apt/trusted.gpg.d/pveport.gpg 
</code></pre>
<p>Aggiorniamo il repository ed il sistema</p>
<pre><code class="language-shell">apt update &amp;&amp; apt full-upgrade
</code></pre>
<h3 id="installiamo-i-pacchetti-proxmox-ve">Installiamo i pacchetti Proxmox VE</h3>
<p>Aggiungiamo <code>ifupdown2</code></p>
<pre><code class="language-shell">apt install ifupdown2
</code></pre>
<p>Ora è il momento dei pacchetti Proxmox VE</p>
<pre><code class="language-shell">apt install proxmox-ve postfix open-iscsi
</code></pre>
<p>Durante questa installazione vengono fatte alcune richieste. Scegliere 'Local only' alla richiesta "Postfix Configuration"</p>
<p><img alt="Postfix Configuration" src="../images/pve-install-postfix.png" /></p>
<p>E Accettare il nome server proposto:</p>
<p><img alt="Postfix Configuration 2" src="../images/pve-install-postfix2.png" /></p>
<p>A termine installazione viene richiesto se mantenere le modifiche al file `/etc/apt/sources.list.d/pveport.list</p>
<pre><code class="language-text">Configuration file '/etc/apt/sources.list.d/pveport.list'
 ==&gt; File on system created by you or by a script.
 ==&gt; File also in package provided by package maintainer.
   What would you like to do about it ?  Your options are:
    Y or I  : install the package maintainer's version
    N or O  : keep your currently-installed version
      D     : show the differences between the versions
      Z     : start a shell to examine the situation
 The default action is to keep your current version.
*** pveport.list (Y/I/N/O/D/Z) [default=N] ?
</code></pre>
<p>Scegliere l'opzione di default <code>N</code></p>
<h2 id="accesso-alla-console-di-controllo-porta-8006">Accesso alla console di controllo (porta 8006)</h2>
<p>Ora il sistema è installato, occorre solo riuscire ad accedere alla console di gestione pubblicata sulla porta 8006.</p>
<p>Possiamo raggiungere questa porta in due modi:</p>
<ul>
<li>pubblicando la porta su internet (modo più semplice ma nmeno sicuro)</li>
<li>utilizzare una connessione VPN come ad esempio Tailscale.</li>
</ul>
<h3 id="pubblicazione-della-porta">Pubblicazione della porta</h3>
<p>Controlla le regole del firewall su OCI</p>
<p>Su Oracle Cloud Infrastructure, devi configurare correttamente le Security Lists o i Network Security Groups (NSG).</p>
<ol>
<li>
<p>Vai su <em>OCI Console</em> -&gt; <em>Networking</em> -&gt; <em>Virtual Cloud Network (VCN)</em></p>
</li>
<li>
<p>Selezione la rete e dal nuovo menù scegli la voce <em>Security Lists</em> poi seleziona la lista presente</p>
</li>
<li>
<p>Aggiungi la nuova regola <em>Add Ingress Rules</em> con i seguenti parametri:</p>
</li>
<li>Source CIDR: Il tuo IP pubblico o 0.0.0.0/0 (se vuoi aprirlo a tutti)</li>
<li>Destination Port Range: 8006</li>
<li>Protocol: TCP</li>
<li>Stateless: No</li>
</ol>
<p><img alt="Oci Ingress Rule" src="../images/oci-ingress-rules.png" /></p>
<p>Ora è possibile accedere alla console di Proxmox tramite l'indirizzo:</p>
<p><code>https://IP_PUBBLICO:8006</code></p>
<h2 id="utilizzo-di-una-vpn-tailscale">Utilizzo di una VPN (Tailscale)</h2>
<p>Potrebbe essere utile configurare la macchina su di una propria VPN in modo che sia facilemnte accessibile dalla propria rete interna.</p>
<p>Personalmente utilizzo <a href="https://tailscale.com">Tailscale</a>. Per eseguire l'installazione di Tailscale sulla macchina si esegue
lo script per l'installazione su piattaforma Linux; da console lanciare il comando:</p>
<pre><code class="language-bash">curl -fsSL https://tailscale.com/install.sh | sh
</code></pre>
<p>Terminata l'installazione proseguire con la registrazione della macchina sulla propria VPN:</p>
<pre><code class="language-bash">sudo tailscale up
</code></pre>
<p>e seguire il link fornito per terminare la registrazione.</p>
<blockquote>
<p>ATTENZIONE</p>
<p>Una volta registrata la macchina si consiglia di disabilitare la scadenza della chiave di connessione
agendo sul menu <code>...</code> e attivando la voce <code>Disable key expiry</code></p>
</blockquote>
<h3 id="configurazione-personalizzata-per-oracle-cloud">Configurazione personalizzata per Oracle Cloud</h3>
<p>Si consiglia di seguire le impostazioni consigliate da Tailscale per la gestione corretta su Cloud Oracle presenti <a href="https://tailscale.com/kb/1149/cloud-oracle">qui</a></p>
<h4 id="1-autorizza-porta-udp-41641">1. Autorizza porta UDP 41641</h4>
<p>Agendo sulla pagina di configurazione di Oracle Cloud selezionere il tab <a href="https://cloud.oracle.com/networking/vcns">Network</a> e selezionare
<strong>Virtual Cloud Networks</strong> e poi selezionare la rete VCN utilizzata dalla macchina virtuale</p>
<p><img alt="oci-vcn" src="../images/oci-vcn.png" /></p>
<p>Selezionare il tab <strong>Security</strong> e poi selezionare la lista di sicurezza (probabilmente l'unica di <em>Default</em>)</p>
<p><img alt="oci-vcn-security" src="../images/oci-vcn-security.png" /></p>
<p>Scegliere <strong>secutity Rules</strong>
A questo punto aggiungere una _Regola ingresso Stateless per 0.0.0.0/0 UDP porta 41641</p>
<p><img alt="oci-ingress-rule-tailscale" src="../images/oci-ingress-rule-tailscale.png" /></p>
<h4 id="2-pubblica-tutta-la-sottorete-vcn-tramite-tailscale">2. Pubblica tutta la sottorete VCN tramite Tailscale</h4>
<p>Può essere utile permettere alla connessione Tailscale di avere accesso a tutta la sottorete delle proprie VM su Oracle.</p>
<p>Da console eseguire il seguente comando</p>
<pre><code class="language-bash">sudo tailscale up --advertise-routes=10.0.0.0/16,169.254.169.254/32 --accept-dns=false
</code></pre>
<blockquote>
<p>NOTA</p>
<p>Affinché la sottorete sia pubblicata effettivamente, occorre agire sulla
"Admin Console" di Tailscale e selezionando il device autorizzare la sottorete.</p>
</blockquote>
<h4 id="3-aggiungere-oracle-dns-alla-tailnet">3. Aggiungere Oracle DNS alla tailnet</h4>
<p>Nella console di amministrazione nella <a href="https://login.tailscale.com/admin/dns">sezione DNS di tailscale</a></p>
<p>Selezionare <code>Add nameserver</code>/<code>Custom...</code></p>
<p>Configurare come da immagine seguente</p>
<p><img alt="tailscale.oraclevcn-dns" src="../images/tailscale-oraclevcn-dns.png" /></p>
<h2 id="accesso-alla-console-e-prima-configurazione">Accesso alla console e prima configurazione</h2>
<p>Una volta che si accede alla console occorre eseguire alcune prime operazioni:</p>
<h3 id="aggiunta-del-repository-di-proxmox">Aggiunta del repository di Proxmox</h3>
<ol>
<li>
<p>Accedi tramite utente <code>root</code> creato durante l'installazione di Debian</p>
</li>
<li>
<p>Seleziona la voce <code>Repositories</code>.</p>
</li>
<li>
<p>Seleziona il comando <code>Add</code></p>
</li>
<li>
<p>Dal popup scegli come Repository <code>No-Subscription</code></p>
</li>
</ol>
<h2 id="creare-un-cluster-proxmox-tra-due-nodi-connessi-tramite-tailscale">Creare un cluster Proxmox tra due nodi connessi tramite tailscale</h2>
<blockquote>
<p>NOTA:
Questa procedura presuppone l'uso di Proxmox 8.</p>
<p>I due nodi in questione saranno qui indicati con <code>pve1</code> e <code>pve2</code>. Occorre accertarsi che comunque non abbiano lo stesso nome.</p>
</blockquote>
<h3 id="1-imposta-correttamente-etchosts-su-entrambi-i-nodi">1. Imposta correttamente /etc/hosts su entrambi i nodi</h3>
<p>In entrambi i nodi editare il file <code>/etc/hosts</code> aggiungendo le seguenti righe:</p>
<pre><code class="language-text">100.x.y.z   pve1
100.a.b.c   pve2
</code></pre>
<p>Usare gli <strong>IP Tailscale</strong> reali al posto di 100.x.y.z e 100.a.b.c</p>
<h3 id="2-creare-il-cluster-sul-nodo-principale-pve1">2. Creare il cluster sul nodo principale (pve1)</h3>
<pre><code class="language-bash">pvecm create nome-cluster
</code></pre>
<p>Importante: A questo punto Proxmox userà la prima interfaccia di rete disponibile.
Per forzare l’uso di Tailscale, modificheremo i file di configurazione subito dopo.</p>
<h3 id="3-modificare-la-configurazione-del-cluster">3. Modificare la configurazione del cluster</h3>
<p>Su <code>pve1</code>, editare il file <code>/etc/pve/corosync.conf</code> e modificare la sezione <code>interface</code>:</p>
<pre><code class="language-text">nodelist{
   node{
      name: pve1
      nodeid: 1
      quorum_votes: 1
      ring0_addr: 100.x.y.z
  }
}
</code></pre>
<p>Inoltre occorre modificare la geestione del "quorum" per permettere l'uso di solo 2 nodi.</p>
<p>Modificare la sezione <code>totem</code> aggiungendo:</p>
<pre><code class="language-text">two_node: 1
wait_for_all: 0
</code></pre>
<p>Poi riavviare il servizio <code>corosync</code></p>
<pre><code class="language-bash">systemctl restart corosync
</code></pre>
<h3 id="4-aggiungere-il-secondo-nodo-pve2">4. Aggiungere il secondo nodo (pve2)</h3>
<p>Sul nodo pve2 eseguire:</p>
<pre><code class="language-bash">pvecm add pve1
</code></pre>
<p>Usare l'<strong>hostname</strong> di <code>pve1</code> per assicurarsi che il cluster venga contattato tramite
Tailscale e che la verifica dell'hostname sia accettata</p>
<p>Il risultato dovrebbe essere qualcosa come:</p>
<pre><code class="language-text">root@pve2:~# pvecm add pve1
Please enter superuser (root) password for 'pve1': ********
Establishing API connection with host 'pve1'
The authenticity of host 'pve1' can't be established.
X509 SHA256 key fingerprint is 9A:6D:E9:9A:DA:49:26:57:2B:57:62:21:A0:53:34:E6:D2:DA:5B:2B:EF:7B:FA:24:8B:71:20:C9:28:B2:00:3C.
Are you sure you want to continue connecting (yes/no)? yes
Login succeeded.
check cluster join API version
No cluster network links passed explicitly, fallback to local node IP '100.x.y.z'
Request addition of this node
Join request OK, finishing setup locally
stopping pve-cluster service
backup old database to '/var/lib/pve-cluster/backup/config-1744145363.sql.gz'
waiting for quorum...OK
(re)generate node files
generate new node certificate
merge authorized SSH keys
generated new node certificate, restart pveproxy and pvedaemon services
successfully added node 'pve2' to cluster.
</code></pre>
<h3 id="5-verificare-lo-stato-del-cluster">5. Verificare lo stato del cluster</h3>
<p>Su qualsiasi nodo eseguire:</p>
<pre><code class="language-bash">pvecm status
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Alessandro Varesi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copiato", "clipboard.copy": "Copia", "search.result.more.one": "1 altro in questa pagina", "search.result.more.other": "# altri in questa pagina", "search.result.none": "Nessun documento trovato", "search.result.one": "1 documento trovato", "search.result.other": "# documenti trovati", "search.result.placeholder": "Scrivi per iniziare a cercare", "search.result.term.missing": "Non presente", "select.version": "Seleziona la versione"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>